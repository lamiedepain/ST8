<!-- apps/planning.html -->
<div class="planning-wrapper">
  <style>
    :root{ --agentw: 180px; --dayw: 26px; --dayfs: 12px; }
    .planning-wrapper{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; background:#f6f9ff; color:#0f172a; padding:16px}
    .container{max-width:100%;margin:0 auto;display:flex;flex-direction:column;gap:12px}
    .toolbar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;background:#fff;border:1px solid #e6edf9;border-radius:12px;padding:10px}
    .toolbar .group{display:flex;gap:8px;align-items:center}
    .toolbar select,.toolbar input{border:1px solid #dbe5f2;border-radius:10px;padding:6px 8px;font-size:14px}
    .toolbar .btn{border:1px solid #dbe5f2;border-radius:10px;padding:6px 10px;background:#eef4ff;color:#1e3a8a;font-weight:600;cursor:pointer}\n    .toolbar .btn:disabled{opacity:0.45;cursor:not-allowed}\n    .color-dot{display:inline-block;width:10px;height:10px;border-radius:50%;margin-right:6px;border:2px solid rgba(255,255,255,0.6);}
    .badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:4px 10px;font-size:12px;font-weight:700;color:#0b1324;background:#f1f5ff;border:1px solid #dbe5f2}
    .badge .dot{width:10px;height:10px;border-radius:50%}
    .panel{background:#fff;border:1px solid #e6edf9;border-radius:12px;overflow:hidden}
    .panel-head{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;background:#eef4ff}
    .panel-body{padding:10px}
    .empty{padding:16px;color:#64748b;text-align:center}
    /* Table */
    .planning-table{border-collapse:separate;border-spacing:0;width:100%;background:#fff;border:1px solid #e6edf9;border-radius:12px;overflow:hidden;table-layout:fixed}
    .planning-table thead th{position:sticky;top:0;background:#f0f7ff;z-index:2}\n    .day-header{display:flex;flex-direction:column;align-items:center;gap:2px}\n    .day-label{font-size:11px;font-weight:600;color:#1e3661;text-transform:uppercase}\n    .day-label.weekend{color:#b91c1c}\n    .day-number{font-size:13px;font-weight:700}
    .planning-table th,.planning-table td{border-right:1px solid #eef4ff;border-bottom:1px solid #eef4ff;padding:4px 6px;font-size:var(--dayfs)}
    .planning-table th.agent-name{position:sticky;left:0;background:#f7fbff;font-weight:700;color:#1e3661;width:var(--agentw);max-width:var(--agentw);z-index:1}
    .planning-table td{height:24px;text-align:center;cursor:pointer;user-select:none}
    .planning-table th.day,.planning-table td.day{width:var(--dayw);min-width:var(--dayw)}
    .planning-table td.weekend{background:#f8fafc;color:#64748b}
    .planning-table td.jf{background:#fff1f2;color:#be123c}
    .planning-table td.offmonth{background:#f1f5f9;color:#94a3b8;cursor:not-allowed}
    .planning-table tr.group-row th{color:#ffffff;font-weight:800;text-align:left}
    .group-header-cell{padding:10px 16px;font-size:14px;letter-spacing:0.4px}
    .planning-table th.agent-name{display:flex;align-items:center;gap:6px;background:inherit;color:inherit}
    .planning-table th.agent-name .agent-id-meta{color:inherit;font-weight:500;opacity:0.7}
    .planning-table td.selected{outline:2px solid #1463c2;outline-offset:-2px}
    /* Status colors (contraste) */
    .status-P{background:#4B5563;color:#ffffff}
    .status-AT{background:#B91C1C;color:#ffffff}
    .status-C{background:#C2410C;color:#ffffff}
    .status-ASTH{background:#1D4ED8;color:#ffffff}
    .status-ASTS{background:#6D28D9;color:#ffffff}
    .status-AM{background:#DC2626;color:#ffffff}
    .status-F{background:#92400E;color:#ffffff}
    .status-RG{background:#BE185D;color:#ffffff}
    .status-CE{background:#B45309;color:#ffffff}
    .status-DC{background:linear-gradient(90deg,#1F2937 50%, #C2410C 50%);color:#ffffff}
    .status-JF{background:#B91C1C;color:#ffffff}
    .selection-badge{display:inline-flex;align-items:center;gap:6px;border-radius:999px;padding:4px 10px;background:#e9d5ff;color:#4c1d95;border:1px solid #d8b4fe;font-weight:700}
    .selection-badge:not(.active){opacity:0.6}
  </style>

  <div class="container">
    <div class="toolbar">
      <div class="group">
        <label for="year-select">Annee</label>
        <select id="year-select"></select>
      </div>
      <div class="group">
        <label for="month-select">Mois</label>
        <select id="month-select"></select>
      </div>
      <div class="group">
        <label for="group-select">Groupe</label>
        <select id="group-select"><option value="">Tous</option></select>
      </div>
      <div class="group" style="flex:1 1 240px">
        <input id="search-agents" placeholder="Recherche agent ou matricule" style="width:100%">
      </div>
      <div class="group">
        <button class="btn" id="btn-import">Import JSON</button>
        <button class="btn" id="btn-export">Export JSON</button>
      </div>
      <div class="group">
        <a class="btn link-btn" href="planning-biweekly.html">Vue bi-hebdo</a>
      </div>
      <div class="group">
        <button class="btn" id="btn-all-present">Tous presents</button>
        <button class="btn" id="btn-undo" disabled>Annuler</button>
        <button class="btn" id="btn-print">Imprimer</button>
      </div>
      <div class="group"><span class="selection-badge">Selection: <span id="selection-count">0</span></span></div>
      <div class="group legend">
        <span class="badge"><span class="dot" style="background:#4B5563"></span>P</span>
        <span class="badge"><span class="dot" style="background:#B91C1C"></span>AT</span>
        <span class="badge"><span class="dot" style="background:#C2410C"></span>C</span>
        <span class="badge"><span class="dot" style="background:#1D4ED8"></span>AST-H</span>
        <span class="badge"><span class="dot" style="background:#6D28D9"></span>AST-S</span>
        <span class="badge"><span class="dot" style="background:#DC2626"></span>AM</span>
        <span class="badge"><span class="dot" style="background:#92400E"></span>F</span>
        <span class="badge"><span class="dot" style="background:#BE185D"></span>RG</span>
        <span class="badge"><span class="dot" style="background:#B45309"></span>CE</span>
        <span class="badge"><span class="dot" style="background:#B91C1C"></span>JF</span>
        <span class="badge"><span class="dot" style="background:linear-gradient(90deg,#1F2937 50%, #C2410C 50%)"></span>DC</span>
      </div>
    </div>

    <section class="panel">
      <div class="panel-head">
        <div style="font-weight:800">Planning annuel</div>
        <div id="count-info" class="badge">0 agents</div>
      </div>
      <div class="panel-body">
        <div id="annual-grid"></div>
      </div>
    </section>
  </div>

  <!-- Palette rapide -->
  <div id="status-modal" style="display:none;position:absolute;min-width:240px;max-width:320px;background:#fff;border:1px solid #e6edf9;border-radius:12px;box-shadow:0 16px 40px rgba(0,0,0,0.18);padding:10px">
    <div style="font-weight:800;margin-bottom:8px">Appliquer un statut</div>
    <div id="quick-palette" style="display:flex;flex-wrap:wrap;gap:8px"></div>
    <div style="margin-top:10px;display:flex;justify-content:flex-end;gap:8px">
      <button type="button" id="btn-clear-status" class="btn">Effacer</button>
      <button type="button" id="btn-close-status" class="btn">Fermer</button>
    </div>
  </div>
</div>

<script src="planning.js"></script>








